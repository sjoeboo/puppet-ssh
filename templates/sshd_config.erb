 Port <%= @port %>
<% if @addressfamily %>
AddressFamily <%= addressfamily %>
<% end -%>
<% if @listenaddress != [] %>
<% @listenaddress.each do |address| %>
ListenAddress <%= address %>
<% end -%>
<% end -%>
<% if @protocol %>
Protocol <%= @protocol %>
<% end -%>

<% @hostkeys.each do |key| %>
HostKey <%= @key %>
<% end -%>

SyslogFacility <%= @syslogfacility %>
LogLevel <%= @server_loglevel %>

LoginGraceTime <%= @logingracetime %>
PermitRootLogin <%= @permitrootlogin %>
StrictModes <%= @strictmodes %>
MaxAuthTries <%= @maxauthtries %>
MaxSessions <%= @maxsessions %>

RSAAuthentication <%= @rsaauthentication %>
PubkeyAuthentication <%= @publickeyauthentication %>

AuthorizedKeysFile  <%= @authorizedkeysfile %>

<% if AuthorizedPrincipalsFile %>
AuthorizedPrincipalsFile <%= @authorizedprincipalsfile %>
<% end -%>

PasswordAuthentication <%= @passwordauthentication %>

ChallengeResponseAuthentication <%= @challengeresponseauthentication %>

<% if @kerberosauthentication == 'yes' %>
# Kerberos options
KerberosAuthentication <%= @kerberosauthentication %>
KerberosOrLocalPasswd <%= @kerberosrrlocalpasswd %>
KerberosTicketCleanup <%= @kerberosticketcleanup %>
KerberosGetAFSToken <%= @kerberosgetafstoken %>
KerberosUseKuserok <%= @kerberosusekuserok %>
<% end -%>

<% if @gssapiauthentication == 'yes' %>
GSSAPIAuthentication <%= @gssapiauthentication %>
GSSAPICleanupCredentials <%= @gssapicleanupcredentials  %>
#GSSAPIStrictAcceptorCheck <%= @gssapistrictacceptorcheck %>
#GSSAPIKeyExchange <%= @gssapikeyexchange %>
#GSSAPIEnablek5users <%= @gssapienablek5users %>
<% end -%>

UsePAM <%= @usepam %>

AllowAgentForwarding <%= @allowagentforwarding  %>
AllowTcpForwarding <%= @allowtcpforwarding  %>
GatewayPorts <%= @gatewayports %>
X11Forwarding <%= @x11forwarding  %>
X11DisplayOffset <%= @x11displayoffset %>
X11UseLocalhost <%= @x11uselocalhost  %>
PermitTTY <%= @permittty %>
PrintMotd <%= @printmotd  %>
PrintLastLog <%= @printlastlog %>
TCPKeepAlive <%= @tcpkeepalive %>
UseLogin <%= @uselogin %>
UsePrivilegeSeparation <%= @useprivilegeseparation  %>
PermitUserEnvironment <%= @permituserenvironment  %>
Compression <%= @compression  %>
ClientAliveInterval <%= @clientaliveinterval %>
ClientAliveCountMax <%= @clientalivecountmax  %>
ShowPatchLevel <%= @showpatchlevel  %>
UseDNS <%= @usedns %>
PidFile <%= @pidfile   %>
MaxStartups <%= @maxstartups %>
PermitTunnel <%= @permittunnel %>
ChrootDirectory <%= @chrootdirectory  %>
VersionAddendum <%= @versionaddendum %>

<%if @banner != 'none' %>
Banner <%= banner %>
<% end -%>

AcceptEnv <%= @acceptenv.join(' ') %>

<% @subsystems.each_pair do |name,server| %>
Subsystem <%= name %> <% server %>
<% end -%>

#Allow user/group rules
<% if @allowusers.length != 0 %>
AllowUsers <%= @allowusers.join(' ') %>
<% end -%>
<% if @allowgroups.length != 0 %>
AllowGroups <%= @allowgroups.join(' ') %>
<% end -%>
#Deny user/group rules
<% if @denyusers.length != 0 %>
DenyUsers <%= @denyusers.join(' ') %>
<% end -%>
<% if @denygroups.length != 0 %>
DenyGroups <%= @denygroups.join(' ') %>
<% end -%>
